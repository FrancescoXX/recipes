#yamlPreprocessor=on

# AI agent environment provides a development space for AI agents to build and version the app.
# Comes with a dev service with the source code and necessary development tools,
# a staging service, email & SMTP testing tool, and a low-resource databases and storage.

project:
  name: laravel-jetstream-agent

services:
  - hostname: appstage
    type: php-nginx@8.4
    zeropsSetup: prod
    buildFromGit: https://github.com/zerops-recipe-apps/laravel-jetstream-app
    enableSubdomainAccess: true
    envSecrets:
      APP_KEY: <@generateRandomString(<32>)>

  - hostname: appdev
    type: php-nginx@8.4
    zeropsSetup: dev
    buildFromGit: https://github.com/zerops-recipe-apps/laravel-jetstream-app
    enableSubdomainAccess: true
    envSecrets:
      APP_KEY: <@generateRandomString(<32>)>

  - hostname: db
    type: postgresql@16
    mode: NON_HA
    priority: 10

  - hostname: redis
    type: valkey@7.2
    mode: NON_HA
    priority: 10

  - hostname: storage
    type: object-storage
    objectStorageSize: 2
    objectStoragePolicy: public-read
    priority: 10

  - hostname: mailpit
    type: go@1
    # FIXME(tikinang): Replace with apps repository.
    buildFromGit: https://github.com/zeropsio/recipe-mailpit
    enableSubdomainAccess: true