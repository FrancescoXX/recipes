# Highly-available production environment provides a production setup
# with enhanced scaling, dedicated resources, and HA components for improved durability and performance.

project:
  name: rust-hello-world-ha-prod
  # Use the highly available, higher-performance core service.
  corePackage: SERIOUS

services:
  # Deploy the Rust Hello World app, running on
  # Rust stable with the compiled binary.
  - hostname: app
    type: rust@stable
    zeropsSetup: prod
    buildFromGit: https://github.com/zerops-recipe-apps/rust-hello-world-app
    # Disabling the subdomain access is recommended,
    # after you set up access through your own domain(s).
    enableSubdomainAccess: true
    # Scale the app to at least 2 runtime containers
    # running simultaneously, with higher than minimal
    # assigned resources.
    minContainers: 2
    maxContainers: 6
    verticalAutoscaling:
      minRam: 0.25
      minFreeRamGB: 0.125

  # Set higher priority for databases,
  # because the app depends on those services.

  # Deploy the PostgreSQL database in highly-available mode,
  # used by the Rust app to store data. Automatic,
  # encrypted backups are enabled by default too.
  - hostname: db
    type: postgresql@16
    mode: HA
    priority: 10
