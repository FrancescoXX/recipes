# Local environment supports local app development using zCLI VPN for database access,
# while ensuring valid deployment processes using a staged app in Zerops.
# Comes with a low-resource database.

project:
  name: rust-hello-world-local

services:
  # Deploy the Rust Hello World stage app, running on
  # Rust stable with the compiled binary.
  # In a typical local development workflow, developers
  # continuously deploy to this stage 'app' service
  # (via zCLI or Git integration) from their local workstation,
  # thus testing the deployment process and deployed
  # app's behavior.
  - hostname: app
    type: rust@stable
    zeropsSetup: prod
    buildFromGit: https://github.com/zerops-recipe-apps/rust-hello-world-app
    # Enable Zerops subdomain,
    # allowing testing the deployed app from outside.
    enableSubdomainAccess: true

  # Deploy low-resource PostgreSQL database,
  # used by the app to store data. Both the staged
  # 'app' service and locally developed app
  # connect to this database. Make this database service
  # locally available via Zerops VPN (zCLI VPN command), making
  # it available on 'db' or 'db.zerops' hostname.
  - hostname: db
    type: postgresql@16
    mode: NON_HA
    priority: 10
