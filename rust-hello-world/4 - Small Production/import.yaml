project:
  name: rust-hello-world-small-production

services:
  # Production application with horizontal autoscaling.
  # minContainers: 2 ensures zero-downtime deploys: new containers start
  # and pass the readiness check before old ones are removed from the
  # project balancer. With a single container, every deploy causes a brief gap.
  #
  # minFreeRamGB reserves headroom above the baseline allocation, protecting
  # against OOM kills during traffic spikes. Rust has no GC, but the Tokio
  # async runtime and connection handling do allocate under load.
  - hostname: app
    type: rust@stable
    zeropsSetup: prod
    buildFromGit: https://github.com/zerops-recipe-apps/rust-hello-world-app
    enableSubdomainAccess: true
    minContainers: 2
    maxContainers: 10
    minRam: 0.125
    minFreeRamGB: 0.05

  # Deploy PostgreSQL database for app data.
  # Priority 10 ensures the database starts before application containers,
  # preventing connection errors during deployment. This startup ordering
  # pattern applies to all data services in this project.
  - hostname: db
    type: postgresql@17
    mode: NON_HA
    priority: 10
